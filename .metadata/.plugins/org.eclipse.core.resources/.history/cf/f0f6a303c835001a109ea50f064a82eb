package ks.test;
import org.junit.Test;

import ks.API.EncryptAPI;

public class testEnvelop {
	private static EncryptAPI ea = new EncryptAPI();
	

	@Test//加密的方法，适用于 当自己是发起方时使用（整合了SM2和SM4）
	public void testEnvelopEncrypt() throws Exception {
		//定义公钥值
		String pk = "D4E5C03CF6B1589024C39EDCB8883A74834FEEA2D6616089F0F3A02ACF5188CAF32B8431964A049D470D6EB8CFEAEB050608B1A0BAD7E127B98856AEC9A1EF48";
		//定义待加密数据明文
		String data = "782E16E20C94423098AC7C7BAF7BEC2DACAF62D56A76171EAA724ED092B41313787A71ED01E637046031BEEAFA59FE63BC87B1F813299DF8C06BBC0DA64BD06A5CE884AF0426731263\n" + 
				"41C3E274D49C80F26B7243BAFED54B7CD6ED3580DC680B147E99E1509470B3D8D545C1BD23AA646A4631A07A28360E3B91D3DF5767CF8AC9742BD88972657EC513F9B19E9E1DFC7CB8F94F8AF0EE3DA5100564AE329BAAFE0C9AF970EBF475E1ADAE2F632AD7ADDFF4980224D209144F33F97BADD1187F";
		
		String[] env = ea.encryptData_Envelop(pk, data);
		String keyByPK = env[0];
		String encData = env[1];
		
		System.out.println("SM2公钥加密SM4密钥值后，密文是: ["+keyByPK+"]");
		System.out.println("SM4密钥将原始报文加密后，密文是: ["+encData+"]");
	}
	
	@Test//解密的方法 适用于 当自己是接收方时使用（整合了SM2和SM4）
	public void testEnvelopDecrypt() throws Exception {
		//定义vk,此值为固定值
		String vk = "ACF0C1E5E777504BB1BF951D205C698322909F4816F740A9E4DD7B592E0525C9";
		//定义待解密数据密文
		String encData = "EDE56F0D2386E31D0766BFE52F28EB90FEDD2582BAF4343C95288A0668AE06E6F964375F21E4FA32A8404CBDA0F8985DC13C9BACD5EB62A81067D25D96A7A5D63ED6FC4E619A71CEC7DE10C402E3CD1A07820EAE3CF8208BE60F563E8045B418B5738E9DC62C053F0107D2F2C7867691E1FD262F1B3EE214FEC4B57B0BF3B549FA8E1DDE20F1A841521DF24D337D4876342A3A8F1C61BEF09C56A5D2111C6A1A61E745D8500D7E52821437462EF9270B999C3043A376631E45E6150A5BAC78845A4371392D44F59C34B6019290E2B9FE2A00A909A1CF35769D3DB8044F78D4A1F220C50834581CB6E4DEAE1A4FC2F544199151A9B5EDAC391A16DE6DE820E27BB01874050ABAFF8A577EF2C67D6ADD100B5E0889B3D4E2D33D78E85848E745DCF5A9BACA3504A7162EF33AE19C89D23C39208B25E0B1CE3435C7D231D611570539031BF8637CFAE54D1CD6DA0971AFB87BF0DFA852A175205C30F2764262EAFD007B6B5B04440D6B17AB40BAC0ABEA1FD3057BD193CD1768021B64E5B91EAD38EB841B47D13B2AA4DE7EF72ABC75DA89";
		//定义keyByPK(值为SM2公钥值加密SM4秘钥后的密文)
		String keyByPK = "7A0780C1E7DF9C4B78202A45F8E2D3878FE284362581AC196E590A39520059CEAF20C0A05F6FB6873D60A3689568ACDF3C4BC3803347FB7FD1AB85929B554A1879BBFBEAEE9EE9E7AE99E2EF08591F3AE50A9984539887417A20942AF1E9686132AFF297946D49E394DDDCF054CFB539";
		
		String[] env = ea.decryptData_Envelop(vk,keyByPK, encData);
		
		String sm4Key = env[0];
		String plainData = env[1];
		
		System.out.println("SM4密钥明文是：["+sm4Key+"]");
		System.out.println("数据明文是：["+plainData+"]");
	}
}
